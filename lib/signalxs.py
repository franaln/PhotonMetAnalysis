# Signal cross sections

gg_xs_file = '/afs/cern.ch/work/f/falonso/Susy/Run2/XS/xs_13TeV_gg/SignalCalc_SUSYTools.txt'
ewk_xs_file = '/afs/cern.ch/work/f/falonso/Susy/Run2/XS/xs_13TeV_ewk_onlyrelevant/SignalCalc_SUSYTools.txt'

#----------------
# Strong grid xs
#----------------

# +------+-------+----------------+-------------+
# |   m3 | mass1 |   crossSection |   Tot_error |
# +------+-------+----------------+-------------+
# | 1000 |  1145 |    0.121755019 | 0.180222496 |
# | 1100 |  1241 |   0.0662688389 | 0.188618302 |
# | 1200 |  1335 |   0.0371481292 | 0.202826485 |
# | 1300 |  1429 |   0.0213276502 | 0.217487603 |
# | 1400 |  1522 |   0.0125334058 | 0.232631654 |
# | 1500 |  1613 |  0.00752641121 | 0.246899739 |
# | 1600 |  1705 |  0.00457510725 | 0.263639212 |
# | 1700 |  1795 |  0.00282816053 | 0.282019496 |
# | 1800 |  1885 |     0.00176476 | 0.298575491 |
# | 1900 |  1974 |  0.00111735344 | 0.314276665 |
# | 2000 |  2063 | 0.000712399138 | 0.332606643 |
# +------+-------+----------------+-------------+

gg_xs = {
    1000:    0.121755019,
    1100:   0.0662688389,
    1200:   0.0371481292,
    1300:   0.0213276502,
    1400:   0.0125334058,
    1500:  0.00752641121,
    1600:  0.00457510725,
    1700:  0.00282816053,
    1800:     0.00176476,
    1900:  0.00111735344,
    2000: 0.000712399138,
    }

gg_xs_unc = {
    1000:    0.180222496,
    1100:    0.188618302,
    1200:    0.202826485,
    1300:    0.217487603,
    1400:    0.232631654,
    1500:    0.246899739,
    1600:    0.263639212,
    1700:    0.282019496,
    1800:    0.298575491,
    1900:    0.314276665,
    2000:    0.332606643,
}

def get_gg_xs(did, m3, mu):

    slha = 'susy.%s.GGM_M3_mu_%s_%s.slha' % (did, m3, mu)

    with open(gg_xs_file) as f:
        for line in f:
            line = line.replace('\n', '')
            if not line or not line.startswith('susy'):
                continue

            slha_, fs_, xs_, _, _, unc_ = line.split()

            if slha_ == slha:
                return (float(xs_), float(unc_))
            
    return None

    

#----------------
# Ewk grid xs
#----------------

ewk_xs_herwig = {
    150: 2.43371,
    200: 0.834933,
    250: 0.356451,
    350: 9.23904e-02,
    450: 3.23256e-02,
    550: 1.30743e-02,
    650: 5.87848e-03,
    750: 2.83376e-03,
    850: 1.43249e-03,
    950: 7.5664e-04,
    1050: 4.06728e-04,
    1150: 2.25701e-04,
    1250: 1.2779e-04,
    1350: 7.22578e-05,
    1450: 4.2227e-05,
    1550: 2.44628e-05,
    1650: 1.41813e-05,
    1750: 8.37812e-06,
    1800: 6.43074e-06,
    }

def get_ewk_xs(did, mu, fs):

    slha = 'susy.%s.GGM_mu_%s.slha' % (did, mu)
    fs = '%s' % fs

    with open(ewk_xs_file) as f:
        for line in f:
            line = line.replace('\n', '')
            if not line or not line.startswith('susy'):
                continue

            slha_, fs_, xs_, _, _, unc_ = line.split()
            if slha_ == slha and fs == fs_:
                return (float(xs_), float(unc_))
            
    return None


ewk_sumw = {

    150: {
        112: 3641.00,
        115: 4198.00,
        117: 2350.00,
        123: 85.00,
        125: 3860.00,
        127: 2154.00,
        135: 107.00,
        137: 54.00,
        157: 3551.00,
        },

    200: {
        111:  1.00,
        112:  3143.00,
        115:  4005.00,
        117:  2088.00,
        123:  347.00,
        125:  4044.00,
        127:  2099.00,
        135:  444.00,
        137:  195.00,
        157:  3634.00,
        },

    250: {
        112:  2892.00,
        115:  3611.00,
        117:  1786.00,
        123:  641.00,
        125:  4141.00,
        127:  2034.00,
        135:  877.00,
        137:  380.00,
        157:  3638.00,
        },

    450: {
        111:  2.00,
        112:  2218.00,
        115:  3083.00,
        117:  1178.00,
        123:  1176.00,
        125:  4524.00,
        127:  1774.00,
        135:  1686.00,
        137:  670.00,
        157:  3689.00,
        },

    650: {
        111:  4.00,
        112:  1958.00,
        113:  3.00,
        115:  2923.00,
        117:  962.00,
        123:  1376.00,
        125:  4925.00,
        127:  1579.00,
        135:  2057.00,
        137:  644.00,
        157:  3569.00,
        },

    850: {
        111:  3.00,
        112:  1819.00,
        113:  2.00,
        115:  2921.00,
        117:  876.00,
        123:  1416.00,
        125:  5063.00,
        127:  1515.00,
        133:  2.00,
        135:  2174.00,
        137:  684.00,
        157:  3525.00,
        },

    1050: {
        112:  1697.00,
        113:  6.00,
        115:  2890.00,
        117:  767.00,
        123:  1422.00,
        125:  5189.00,
        127:  1457.00,
        133:  2.00,
        135:  2414.00,
        137:  623.00,
        157:  3533.00,
        },
        
    1250: {
        111:  4.00,
        112:  1655.00,
        113:  5.00,
        115:  2914.00,
        117:  721.00,
        123:  1438.00,
        125:  5253.00,
        127:  1321.00,
        133:  1.00,
        135:  2514.00,
        137:  621.00,
        157:  3553.00,
        },

    1450: {
        111:  5.00,
        112:  1616.00,
        113:  5.00,
        115:  2938.00,
        117:  709.00,
        123:  1440.00,
        125:  5282.00,
        126:  1.00,
        127:  1352.00,
        133:  3.00,
        135:  2510.00,
        137:  608.00,
        148:  1.00,
        157:  3530.00,
        },

    1650: {
        111:  10.00,
        112:  1635.00,
        113:  11.00,
        115:  2817.00,
        117:  661.00,
        118:  1.00,
        123:  1504.00,
        125:  5215.00,
        127:  1286.00,
        133:  3.00,
        135:  2514.00,
        137:  581.00,
        138:  1.00,
        146:  2.00,
        157:  3757.00,
        158:  1.00,
        168:  1.00,
        },

    1850: {
        111:  8.00,
        112:  1571.00,
        113:  14.00,
        115:  2838.00,
        117:  620.00,
        123:  1466.00,
        125:  5260.00,
        126:  2.00,
        127:  1230.00,
        133:  3.00,
        134:  1.00,
        135:  2528.00,
        137:  611.00,
        146:  3.00,
        157:  3841.00,
        168:  4.00,
        }
}

def get_ewk_sumw(mu, fs):

    sumw = 0
    try: 
        sumw = ewk_sumw[mu][fs]
    except:
        pass

    return sumw



